<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>XAI: Explainable artificial intelligence</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="Machine learning algorithms usually operate as black boxes and it is unclear how they derived a certain decision. This book is a guide for practitioners on how to make machine learning decisons more explainable.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="XAI: Explainable artificial intelligence" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Machine learning algorithms usually operate as black boxes and it is unclear how they derived a certain decision. This book is a guide for practitioners on how to make machine learning decisons more explainable." />
  <meta name="github-repo" content="christophM/xai-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="XAI: Explainable artificial intelligence" />
  
  <meta name="twitter:description" content="Machine learning algorithms usually operate as black boxes and it is unclear how they derived a certain decision. This book is a guide for practitioners on how to make machine learning decisons more explainable." />
  

<meta name="author" content="Christoph Molnar">


<meta name="date" content="2017-04-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="simple.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#who-is-this-book-for"><i class="fa fa-check"></i><b>1.1</b> Who is this book for?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#what-is-machine-learning-and-why-is-it-important"><i class="fa fa-check"></i><b>1.2</b> What is machine learning and why is it important?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#why-is-explainability-important"><i class="fa fa-check"></i><b>1.3</b> Why is explainability important?</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#is-a-good-user-experience-enough"><i class="fa fa-check"></i><b>1.4</b> Is a good user experience enough?</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#outline-of-the-book"><i class="fa fa-check"></i><b>1.5</b> Outline of the book</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#scope-of-explainability"><i class="fa fa-check"></i><b>1.6</b> Scope of explainability</a><ul>
<li class="chapter" data-level="1.6.1" data-path="intro.html"><a href="intro.html#algorithm-transparency"><i class="fa fa-check"></i><b>1.6.1</b> Algorithm transparency</a></li>
<li class="chapter" data-level="1.6.2" data-path="intro.html"><a href="intro.html#global-holistic-model-explainability"><i class="fa fa-check"></i><b>1.6.2</b> Global, holistic model explainability</a></li>
<li class="chapter" data-level="1.6.3" data-path="intro.html"><a href="intro.html#global-model-explainability-on-a-modular-level"><i class="fa fa-check"></i><b>1.6.3</b> Global model explainability on a modular level</a></li>
<li class="chapter" data-level="1.6.4" data-path="intro.html"><a href="intro.html#explain-the-decision-for-a-single-instance"><i class="fa fa-check"></i><b>1.6.4</b> Explain the decision for a single instance</a></li>
<li class="chapter" data-level="1.6.5" data-path="intro.html"><a href="intro.html#explain-the-decisions-for-a-group-of-instances"><i class="fa fa-check"></i><b>1.6.5</b> Explain the decisions for a group of instances</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#tool-vs.product"><i class="fa fa-check"></i><b>1.7</b> Tool vs. product</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#evaluating-explainability"><i class="fa fa-check"></i><b>1.8</b> Evaluating explainability</a><ul>
<li class="chapter" data-level="1.8.1" data-path="intro.html"><a href="intro.html#approaches-for-evaluation-of-the-explanation-quality"><i class="fa fa-check"></i><b>1.8.1</b> Approaches for evaluation of the explanation quality</a></li>
<li class="chapter" data-level="1.8.2" data-path="intro.html"><a href="intro.html#function-level-evaluation"><i class="fa fa-check"></i><b>1.8.2</b> Function level evaluation</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#definitions"><i class="fa fa-check"></i><b>1.9</b> Definitions</a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#terminology"><i class="fa fa-check"></i><b>1.10</b> Terminology</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simple.html"><a href="simple.html"><i class="fa fa-check"></i><b>2</b> Keep it simple</a><ul>
<li class="chapter" data-level="2.1" data-path="simple.html"><a href="simple.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="simple.html"><a href="simple.html#limo"><i class="fa fa-check"></i><b>2.2</b> Linear models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="simple.html"><a href="simple.html#interpretation"><i class="fa fa-check"></i><b>2.2.1</b> Interpretation</a></li>
<li class="chapter" data-level="2.2.2" data-path="simple.html"><a href="simple.html#interpretation-example"><i class="fa fa-check"></i><b>2.2.2</b> Interpretation example</a></li>
<li class="chapter" data-level="2.2.3" data-path="simple.html"><a href="simple.html#visual-parameter-interpretation"><i class="fa fa-check"></i><b>2.2.3</b> Visual parameter interpretation</a></li>
<li class="chapter" data-level="2.2.4" data-path="simple.html"><a href="simple.html#explaining-single-predictions"><i class="fa fa-check"></i><b>2.2.4</b> Explaining single predictions</a></li>
<li class="chapter" data-level="2.2.5" data-path="simple.html"><a href="simple.html#interpretation-templates"><i class="fa fa-check"></i><b>2.2.5</b> Interpretation templates</a></li>
<li class="chapter" data-level="2.2.6" data-path="simple.html"><a href="simple.html#coding-categorical-variables"><i class="fa fa-check"></i><b>2.2.6</b> Coding categorical variables:</a></li>
<li class="chapter" data-level="2.2.7" data-path="simple.html"><a href="simple.html#assuring-sparsity-in-linear-models"><i class="fa fa-check"></i><b>2.2.7</b> Assuring sparsity in linear models</a></li>
<li class="chapter" data-level="2.2.8" data-path="simple.html"><a href="simple.html#the-disadvantages-of-linear-models"><i class="fa fa-check"></i><b>2.2.8</b> The disadvantages of linear models</a></li>
<li class="chapter" data-level="2.2.9" data-path="simple.html"><a href="simple.html#towards-complexer-relationships-within-linear-model-class"><i class="fa fa-check"></i><b>2.2.9</b> Towards complexer relationships within linear model class</a></li>
<li class="chapter" data-level="2.2.10" data-path="simple.html"><a href="simple.html#linear-models-beyond-gaussian-regression"><i class="fa fa-check"></i><b>2.2.10</b> Linear models beyond gaussian regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="simple.html"><a href="simple.html#decision-trees"><i class="fa fa-check"></i><b>2.3</b> Decision trees</a><ul>
<li class="chapter" data-level="2.3.1" data-path="simple.html"><a href="simple.html#interpretation-1"><i class="fa fa-check"></i><b>2.3.1</b> Interpretation</a></li>
<li class="chapter" data-level="2.3.2" data-path="simple.html"><a href="simple.html#interpretation-example-1"><i class="fa fa-check"></i><b>2.3.2</b> Interpretation example</a></li>
<li class="chapter" data-level="2.3.3" data-path="simple.html"><a href="simple.html#advantages"><i class="fa fa-check"></i><b>2.3.3</b> Advantages</a></li>
<li class="chapter" data-level="2.3.4" data-path="simple.html"><a href="simple.html#disadvantages"><i class="fa fa-check"></i><b>2.3.4</b> Disadvantages</a></li>
<li class="chapter" data-level="2.3.5" data-path="simple.html"><a href="simple.html#explaining-treeinterpreter"><i class="fa fa-check"></i><b>2.3.5</b> Explaining: Treeinterpreter</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simple.html"><a href="simple.html#rulefit"><i class="fa fa-check"></i><b>2.4</b> RuleFit</a></li>
<li class="chapter" data-level="2.5" data-path="simple.html"><a href="simple.html#decision-rules"><i class="fa fa-check"></i><b>2.5</b> Decision rules</a><ul>
<li class="chapter" data-level="2.5.1" data-path="simple.html"><a href="simple.html#association-rule-mining"><i class="fa fa-check"></i><b>2.5.1</b> Association rule mining</a></li>
<li class="chapter" data-level="2.5.2" data-path="simple.html"><a href="simple.html#rule-induction"><i class="fa fa-check"></i><b>2.5.2</b> Rule induction</a></li>
<li class="chapter" data-level="2.5.3" data-path="simple.html"><a href="simple.html#other-algorithms"><i class="fa fa-check"></i><b>2.5.3</b> Other algorithms</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="simple.html"><a href="simple.html#interpretation-overview"><i class="fa fa-check"></i><b>2.6</b> Interpretation overview</a></li>
<li class="chapter" data-level="2.7" data-path="simple.html"><a href="simple.html#monotonicity-constraints-between-features"><i class="fa fa-check"></i><b>2.7</b> Monotonicity constraints between features</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Explain the data</a><ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#visualizations"><i class="fa fa-check"></i><b>3.1</b> visualizations</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#pca"><i class="fa fa-check"></i><b>3.2</b> PCA</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#mds"><i class="fa fa-check"></i><b>3.2.1</b> MDS</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#t-sne"><i class="fa fa-check"></i><b>3.2.2</b> t-SNE</a></li>
<li class="chapter" data-level="3.2.3" data-path="data.html"><a href="data.html#glyphs"><i class="fa fa-check"></i><b>3.2.3</b> Glyphs</a></li>
<li class="chapter" data-level="3.2.4" data-path="data.html"><a href="data.html#correlation-graphs"><i class="fa fa-check"></i><b>3.2.4</b> Correlation Graphs</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#biases.-source-httpsen.m.wikipedia.orgwikibias_statistics"><i class="fa fa-check"></i><b>3.3</b> Biases. Source: <a href="https://en.m.wikipedia.org/wiki/Bias_(statistics)" class="uri">https://en.m.wikipedia.org/wiki/Bias_(statistics)</a></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html"><i class="fa fa-check"></i><b>4</b> Model-agnostic explanations</a><ul>
<li class="chapter" data-level="4.1" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#justification-narrative-structure-for-classification"><i class="fa fa-check"></i><b>4.1</b> Justification narrative structure for classification</a><ul>
<li class="chapter" data-level="4.1.1" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#example-justification-narratives-with-the-vehicle-data-set"><i class="fa fa-check"></i><b>4.1.1</b> Example justification narratives with the vehicle data set</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#global-explain-the-behaviour-of-a-model"><i class="fa fa-check"></i><b>4.2</b> Global: Explain the behaviour of a model</a><ul>
<li class="chapter" data-level="4.2.1" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#global-surrogate-models"><i class="fa fa-check"></i><b>4.2.1</b> Global surrogate models</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#local-explain-a-single-decisions"><i class="fa fa-check"></i><b>4.3</b> Local: Explain a single decisions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#local-surrogate-models-lime"><i class="fa fa-check"></i><b>4.3.1</b> Local surrogate models (LIME)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#explanation-types"><i class="fa fa-check"></i><b>4.4</b> Explanation types</a><ul>
<li class="chapter" data-level="4.4.1" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#structured-output"><i class="fa fa-check"></i><b>4.4.1</b> Structured output</a></li>
<li class="chapter" data-level="4.4.2" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#viz-explanation"><i class="fa fa-check"></i><b>4.4.2</b> Visualization</a></li>
<li class="chapter" data-level="4.4.3" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#natural-language-narratives"><i class="fa fa-check"></i><b>4.4.3</b> Natural language (narratives)</a></li>
<li class="chapter" data-level="4.4.4" data-path="model-agnostic-explanations.html"><a href="model-agnostic-explanations.html#examples-and-prototypes"><i class="fa fa-check"></i><b>4.4.4</b> Examples and prototypes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="specific.html"><a href="specific.html"><i class="fa fa-check"></i><b>5</b> Model-specific explanations for complex models</a><ul>
<li class="chapter" data-level="5.1" data-path="specific.html"><a href="specific.html#global-explanations"><i class="fa fa-check"></i><b>5.1</b> Global explanations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="specific.html"><a href="specific.html#random-forests-treeinterpreter"><i class="fa fa-check"></i><b>5.1.1</b> Random Forests: Treeinterpreter</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">XAI: Explainable artificial intelligence</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<!--TODO: Add some quote here -->
<div id="who-is-this-book-for" class="section level2">
<h2><span class="header-section-number">1.1</span> Who is this book for?</h2>
<p>This book is for everyone who wants to learn how to make machine learning models more explainable.</p>
<p>It is a recommended reading for machine learning practitioners, statisticians, data scientists, scientists and everyone who has contact with machine learning applications. It contains one or the other formula, but it’s kept at a manageable level of math. This book is not for people who are trying to learn machine learning from scratch. If you want to learn machine learning, there are loads of books and other resources for learning the basics.</p>
</div>
<div id="what-is-machine-learning-and-why-is-it-important" class="section level2">
<h2><span class="header-section-number">1.2</span> What is machine learning and why is it important?</h2>
<p>Recommendation of products, identifying street signs, counting people on the street, assessing a person’s credit worthiness, detecting fraud: All these examples have in common that they can, and are increasingly, realized with machine learning algorithms. The tasks are different, but the approach is the same: Step 1 is to collect data. This can be images with and without street signs plus the information which sign is visible or the personal data from loan applicants together with the information if they repaid their loan or not. Step 2: Feed this information into a machine learning algorithm, which produces a sign detector model or a credit worthiness model. This model can then be used in Step 3: Integrate the model into the product or process, like an self-driving car or a loan application process.</p>
<p>There are a lot of tasks in which machines exceed humans. Even if the machine is as good as a human at a task, or slightly worse, there remains big advantages, and that is speed, reproducibility and scale. A machine learning model that has been implemented once, can do a task much faster than humans, will reliably produce the same results from the same input and can be copied endlessly.</p>
</div>
<div id="why-is-explainability-important" class="section level2">
<h2><span class="header-section-number">1.3</span> Why is explainability important?</h2>
<p>AI explainability is the ability of a machine learning system to explain or to present a decision in an understandable way for humans. Machine learning has come to a state where you have to make a trade-off: Do you simply want to know <strong>what</strong> will happen? For example if a client will churn or if medication will work well for a patient. Or do you want to know <strong>why</strong> something will happen and paying for the explainability with accuracy? In some cases you will not care why a decision was made, only the assurance that the accuracy was good on some test set is enough. But in other cases knowing the ‘why’ can help you understand more about the problem, the data and also know why a model might fail. Two sorts of problems might not need explanations, because they either are low risk (e.g. movie recommender system) or the method is already extensively studied and evaluated (e.g. optical character recognition). The necessity for explainability comes from an incompleteness in the problem formalization <span class="citation">(Doshi-Velez and Kim <a href="#ref-Doshi-Velez2017">2017</a>)</span>, meaning that for certain problems/tasks it is not enough to get the answer (the “what”), but the model also has to give an explanation (the *why**)</p>
<ul>
<li>There is a shift in many scientific disciplines <!--TODO> Add example disciplines--> from qualitative to quantitative methods (e.g. sociology, psychology), and also towards machine learning (biology, genomics). The <strong>goal of science</strong> is to gain knowledge, but many problems can only be solved with big datasets and black box machine learning models. Explainability allows to extract additional knowledge.</li>
<li>Machine learning models are taking over real world tasks, that demand <strong>safety measurements</strong> and testing. A self-driving car automatically detects cyclists, which is as desired. You want to bet 100% sure that the abstraction the system learned will be fail-safe, because running over cyclists is quite bad. An explanation might reveal that the most important feature learned is to recognize the two wheels of a bike and this explanation helps to think about edge cases like bikes with side bags, that partially cover the wheels.</li>
<li>By default most machine learning models pick up biases from the training data. This can turn your machine learning models into racists (see Microsoft failed experiment: Tay) or discriminate in against other demographic, protected groups. Explainability helps you to get the <strong>ethics</strong> of your machine learning model right. From the data it might not be possible to see the biases, so it might also not be enough to implement protections against known biases. An example: The goal is to train a machine learning model to pre-sort applications for jobs in a big company. The company had some troubles in the past because they preferred to hire men over women, having the same qualifications. So for the model training the data scientist decides to remove all features that indicate the gender. But it turns out that the model picks up another, a priori unknown, bias favoring younger people over older people. This could only be uncovered because the model is explainable.</li>
<li>Sometimes it is not possible to optimize a goal directly, but only a proxy. Consider a marketing where a e-commerce company sends some gift to some customers in order to bind them to the business. It has already done similar campaigns, so there is data to learn a model to select the best customers to send the gifts to (sending it to all would be far to expensive). Ideally the company wants to optimize the likelihood that the customers with the gift are still their customers in five years from now, but there is no data for optimizing this goal directly, because the first of theses kinds of campaigns was two years ago, meaning there is no suitable training data for this objective. So the company opts for using a proxy: The amount of money the customers will be spending in the next 6 months at your company. An explainable model can help to find problems that might arise due to using a proxy objective (possibly <strong>mismatched objectives</strong>). In the e-commerce case it might turn out that the customers selected by the algorithm are only international students that might spent heavily in a short time, even more after receiving a gift, but usually leave the country and therefore the company as a customer within a few years.In many scientific questions, like in longitudinal observational studies, the researcher wants to uncover causal relationships, like the therapy effect on some disease outcome measurement, but all algorithms only pick up and optimize the correlation which the researcher is only interested in if it is causal.</li>
<li>In volatile environments a machine learning model might be outdated at some point because of a <strong>data shift</strong>. A data shift is a change in the relationships in the data. Explanation make it easier to detect when that happens or if one model is more prone than another to face problems soon. Spam filter for mails use works in a mail to detect if they should reach your inbox or be moved into the spam folder. ‘Viagra’ is one of the words that increase the likelihood that a mail is spam. When ‘viagra’ is suddenly used in a different context, for some obscure reason, suddenly non-spam mails will land in the spam folder (like ‘Random forests are basically a bunch of decision trees on viagra’). An investigation of this problem might reveal very quickly that the data shift (‘viagra’-occurrence / spam reluationship) is caused by the new use of the former spam related word. An explainable model could highlight in the text which sections caused the spam classification. A special case of a data shift is when the outcome of the machine learning model influences its environment and therefore its future training data. An example is the optimization of marketing campaigns. The machinee learning model influences which people will be targeted by the campaign and therefore influence who will be part of the future training set and also possibly invalidate its own predictions.</li>
<li>Sometimes training of machine learning models happens with training data that comes from a different distribution as the live data with which the model will be confronted with in production. The machine learning team basically trains the model on the dedicated training dataset, crosses their fingers and put it into production. The hope is, that the learned associations between the features and the output has a good <strong>generalization from training to production</strong>. The training data for a fracture detection machine learning model might come from labeled radiographs that were done with a handful of different x-ray devices. But the company hopes to use their fracture detection algorithm in their software that they sell to hundreds of hospitals that likely use different machines. Explainable machine learning models can give the engineers the confidence that the model only picked up relationships that will generalize well for new datasets.</li>
<li>Even if the problem formalization is complete, there might be an unknown <strong>trade-off between objectives</strong> like predictive ability and not being racis. A machine learning model that decides for a bank whether customers should receive a loan or not has many objectives to take care of: For the bank it is important that the customers will pay their loan back and not default. This can be directly optimized by training on historical data with customer data and information if they defaulted on a loan or not. The customers with the best scores (highest probability of paying back the loan without problems) are the ones the bank would want to give a loan. At the same time the bank has to ensure that the algorithm is not discriminating against a demographic minority like race or religion. Also there might be other regulatory or legal requirements the bank has to be aware of when giving out loans. These additional objectives cannot be directly optimized, but explanations can fill the gap.</li>
</ul>
<p>Besides these scenarios with an incompleteness to of the problem formalization, there is also the task of debugging a machine learning model, which is crucial and difficult. Explainability is a useful debugging tool for black box algorithm. So even in low risk environments (e.g. movie recommenders) explainability in the research and development stage is valuable. Also later when some model is used in a product, things can go wrong. And needed for explainability arises when something goes wrong. Because having an explanation for a faulty classification helps to understand the cause of the fault. It delivers a direction for how to fix the system. Consider an example of a husky versus wolf classifier, that missclassifies some huskys as wolfs. If there is an explanation to the classification you can see, that the missclassification happened due to the snow on the image. The classifier learned to use snow as a feature for classifying images as wolfs, which might make sense in terms of separating features in the training data set, but not in the real world use. <!--TODO: Add image from Ribeiro + ask for permission]--></p>
</div>
<div id="is-a-good-user-experience-enough" class="section level2">
<h2><span class="header-section-number">1.4</span> Is a good user experience enough?</h2>
<p>Maybe it is enough to show that the algorithm works and does what it is supposed to. The recommended movies are all reasonable and my self-driving car never had an accident.</p>
<p>We have to distinguish between between low and high stakes scenario and individual risks and systematic biases. For low-risk applications (e.g. product recommender systems) there is not so much damage if something goes wrong. No one will die because they got a product recommendation on Amazon for something they are not interested in. Biggest risk is for the company deploying those algorithms that they do not work and loose customers to competitors. But there is the risk for a systematic bias and while for each individual the impact might be negligible on a group or society level it is quite problematic. Social bubbles through newsfeeds? An example is a restaurant recommender system that would never recommend restaurants to a certain minority, because they are from that minority.</p>
<p>High risk applications are self-driving cars, AI doctors etc. Here it is quite important to have explainability. Only with explainability can you ‘debug’ why a car accident happened by a self-driving car or decide if you want to trust the diagnose of a machine learning algorithm.</p>
</div>
<div id="outline-of-the-book" class="section level2">
<h2><span class="header-section-number">1.5</span> Outline of the book</h2>
<p>This book starts out with framing the problem: What aspects does explainability have? It goes on and lays out the ‘simple’ machine learning models (linear models, decision trees, decision rules) that come with interpretability. The following chapter explains different methods for explaining and understanding the data better, followed by the core chapter about methods for explaining the output of any black box model. Later methods that are specific for certain model classes are shown. The book concludes with an outlook on the future.</p>
</div>
<div id="scope-of-explainability" class="section level2">
<h2><span class="header-section-number">1.6</span> Scope of explainability</h2>
<p>An algorithm trains a model, which produces the predictions. Each step can be evaluated in terms of transparency or explainability.</p>
<div id="algorithm-transparency" class="section level3">
<h3><span class="header-section-number">1.6.1</span> Algorithm transparency</h3>
<p>How does the algorithm create the model?</p>
<p>Algorithm transparency is about how the algorithm learns a model from data and what kind of relationships it is capable of picking up. If you are using convolutional neural networks for classifying images, you can explain that the algorithm learns edge detectors and filters on the lowest layers. This is an understanding of how the algorithm works, but not of the specific model that is learned in the end and not about how single predictions are made. For this level of transparency only knowledge about the algorithm and not about the data or concrete learned models are required. This book focuses on model explainability. Algorithms like the least squares method for linear models are well studied and understood. They score high in transparency. Deep learning approaches (pushing a gradient through a network with millions of weights) are less understood and the inner workings are in the focus on-going research. It is not clear how they exactly work, so they are less transparent.</p>
</div>
<div id="global-holistic-model-explainability" class="section level3">
<h3><span class="header-section-number">1.6.2</span> Global, holistic model explainability</h3>
<p>How does the trained model make predictions?</p>
<p>You could call a model explainable, if you can comprehend the whole model at once <span class="citation">(<span class="citeproc-not-found" data-reference-id="Lipton2016"><strong>???</strong></span>)</span>. To explain the global model output, you need the trained model, knowledge about the algorithm and the data. This level of explainability is about understanding how the model makes the decisions, based on a holistic few on it’s features and each learned components like weights, parameters and structures. Which features are the important ones and what kind of interactions are happening? Global model explainability helps to understand the distribution of your target variable based on the features. Arguably, global model explainability is very hard to achieve in practice. Any model that exceeds a handful of parameters or weights, probably won’t fit an average human’s brain capacity. I’d argue that you cannot really imagine a linear model with 5 features and draw in your head the hyperplane that the was estimated in the 5-dimensional feature space. Each feature space with more than 3 dimensions is just not imaginable for humans. Usually when people try to comprehend a model, they look at parts of it, like the weights in linear models.</p>
</div>
<div id="global-model-explainability-on-a-modular-level" class="section level3">
<h3><span class="header-section-number">1.6.3</span> Global model explainability on a modular level</h3>
<p>How do parts of the model influence predictions?</p>
<p>You might not be able to comprehend a naive bayes model with many hundred features, because there is no way you could hold all the feature weights in your brain’s working memory. But you can understand a single weight easily. Not many models are explainable on a strict parameter level.While global model explainability is usually out of reach, there is a better chance to understand at least some models on a modular level. In the case of linear models parts to understand are the weights and the distribution of the features, for trees it would be splits (used feature and cut-off point) and leaf node predictions. Linear models for example look like they would be, but the interpretation of a single weight is interlocked with all of the other weights. As you will see in Chapter [#limo], the interpretation of a single weight always comes with the footnote that the other input features stay at the same way value, which is not the case in many real world applications. A linear model predicting the rent of a flat, which takes into account both the size of the flat and the number of rooms might have a negative weight for the rooms feature, which is counter intuitive. But it can happen, because there is already the highly correlated flat size feature and in a market where people prefer bigger rooms, a flat with more rooms might be worth less than a flat with more rooms and same square meters. The weights only make sense in the light of the other features used in the model. But arguably a linear models weights still have better explainability than the weights of a deep neural network.</p>
</div>
<div id="explain-the-decision-for-a-single-instance" class="section level3">
<h3><span class="header-section-number">1.6.4</span> Explain the decision for a single instance</h3>
<p>Why did the model make a specific decision for an instance?</p>
<p>You can go all the way down to a single observation and examine what kind of classification or decision the model gives for this input, and why it made this decision. When you look at one example, the local distribution of the target variable might behave more nicely. Locally it might depend only linearly or monotonic on some variables rather than having a complex dependency on the features. For example the rent of an apartment might not depend linearly on the size, but if you only look at a specific apartment of 100 square meter and check how the prize changes going up plus and minus 10 square meters there is a chance that this sub region in your data space is linear. Local explanations can be more accurate compared to global explanations because of this.</p>
</div>
<div id="explain-the-decisions-for-a-group-of-instances" class="section level3">
<h3><span class="header-section-number">1.6.5</span> Explain the decisions for a group of instances</h3>
<p>Why did the model make specific decisions for a group of instances?</p>
<p>The model output for multiple instances can be explained by using methods for global model explainability and single instance explanations. The global methods can be applied by taking the group of observations pretending it’s the complete dataset and using the global methods on this subset. The single explanation methods can be used on each instance and listed or aggregated afterwards for the whole group.</p>
</div>
</div>
<div id="tool-vs.product" class="section level2">
<h2><span class="header-section-number">1.7</span> Tool vs. product</h2>
<p>Explainability can be either a tool to analyze the machine learning model or a part of the final product.</p>
</div>
<div id="evaluating-explainability" class="section level2">
<h2><span class="header-section-number">1.8</span> Evaluating explainability</h2>
<p>There is no real consensus what explainability in machine learning is. Also it is not clear how to measure it.</p>
<div id="approaches-for-evaluation-of-the-explanation-quality" class="section level3">
<h3><span class="header-section-number">1.8.1</span> Approaches for evaluation of the explanation quality</h3>
<p><span class="citation">(Doshi-Velez and Kim <a href="#ref-Doshi-Velez2017">2017</a>)</span> proposes 3 major levels of evaluating explainability. - Application level evaluation (real task): Put the explanation into the product and let the end user test it. On an application level the radiologists would test the fracture detection software in order to evaluate the model. This requires a good experimental setup and an idea of how to assess the quality. A good baseline for this is always how good a human would be at explaining the same decision. - Human level evaluation (simple task) is a simplified application level evaluation. The difference is that these experiments are not conducted with the domain experts, but with lay humans. This makes experiments less expensive (especially when the domain experts are radiologists) and it is easier to find more humans. An example would be to show a user different explanations and the human would choose the best . - Function level evaluation (proxy task) does not require any humans. This works best when the class of models used is already evaluated by someone else in a human level evaluation.</p>
</div>
<div id="function-level-evaluation" class="section level3">
<h3><span class="header-section-number">1.8.2</span> Function level evaluation</h3>
<p>Model size is an easy way to measure, but might be too simplistic.</p>
<p>Dimensions of interpretability: - Model sparsity: How many features are being used by the explanation? - Monotonicity: Is there a Monotonicity constraint? - Uncertainty: Is a measurement of uncertainty part of the explanation? - Interactions: Is the explanation able to include interaction of features? - Cognitive processing time: How long does it take to understand the explanation. - Feature complexity: What features were used for the explanation? PCA components are harder to understand than word occurrences for example. - Description length of explanation</p>
<p>If you can ensure that the machine learning model can explain decisions, following traits can also be checked more easily <span class="citation">(Doshi-Velez and Kim <a href="#ref-Doshi-Velez2017">2017</a>)</span>. - Fairness: Unbiased, not discrimating against protected groups (implicit or explicit). An interpretable model can tell you why it decided it decided a certain person is not worthy of a credit and for a human it becomes easy to decide if the decision was based on a learned demographic (e.g. racial) bias. - Privacy: sensitive information in the data is protected. - Reliability/Robustness: Small changes in the input don’t lead to big changes in the ouput/decision. - Causality: Only causal relationships are picked up. So a predicted change in a decision due to arbitrary changes in the input values, are also happening in reality. - Usability: - Trust: It is easier for humans to trust into a system that explains it’s decisions compared to a black box</p>
</div>
</div>
<div id="definitions" class="section level2">
<h2><span class="header-section-number">1.9</span> Definitions</h2>
<ul>
<li>An <strong>Algorithm</strong> is a set of rules that a machine follows to achieve a particular goal <span class="citation">(“Definition of Algorithm,” n.d.)</span></li>
<li><strong>Machine learning algorithm</strong> is an set of rules that a machine follows to learn how to a achieve a particular goal. The output of a machine learning algorithm is a machine learning model.</li>
<li><strong>(Machine learning) Model</strong> is the outcome of a machine learning algorithm. This can be a set of weights for a linear model or neural network plus the architecture.</li>
<li><strong>Features</strong> are the variables/information used for prediction/classification/clustering.</li>
<li><strong>(machine learning) Task</strong> can be classification, regression, survival analysis, clustering, outlier detection</li>
<li><strong>Instance</strong> One row in the dataset.</li>
</ul>
</div>
<div id="terminology" class="section level2">
<h2><span class="header-section-number">1.10</span> Terminology</h2>
<p>Y is the target variable in supervised settings. X are the features or covariates. w are the weights. $% are regression weights.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Doshi-Velez2017">
<p>Doshi-Velez, Finale, and Been Kim. 2017. “Towards A Rigorous Science of Interpretable Machine Learning,” no. Ml: 1–13. <a href="http://arxiv.org/abs/1702.08608" class="uri">http://arxiv.org/abs/1702.08608</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
